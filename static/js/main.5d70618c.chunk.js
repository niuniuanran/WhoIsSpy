(this["webpackJsonpwho-is-spy"]=this["webpackJsonpwho-is-spy"]||[]).push([[0],{112:function(e,t,n){},143:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(12),i=n.n(r),o=(n(112),n(27)),s=n(15),l=n(177),j=n(179),d=n(174),u=n(1),b=Object(d.a)((function(e){return{option:{height:"5rem",width:"15rem",fontSize:"1.5rem"},iconSpan:{fontSize:"2rem",paddingRight:"1rem"}}}));function m(e){var t=e.text,n=e.path,a=e.icon,c=b(),r=Object(s.f)();return Object(u.jsx)(l.a,{item:!0,xs:12,children:Object(u.jsxs)(j.a,{variant:"contained",size:"large",color:"primary",className:c.option,onClick:function(){r.push(n)},children:[Object(u.jsx)("span",{className:c.iconSpan,children:a}),Object(u.jsx)("span",{children:t})]})})}var h=n(75),O=n.n(h),x=c.a.createContext(void 0);function p(e){var t=e.language,n=e.children,a={newRoom:{en:"New room",cn:"\u65b0\u5efa\u623f\u95f4"},joinRoom:{en:"Join room",cn:"\u52a0\u5165\u623f\u95f4"},addWords:{en:"Contribute",cn:"\u8d21\u732e\u8bcd\u6761"},randomBlank:{en:"Spy can be blank",cn:"\u5367\u5e95\u53ef\u4ee5\u662f\u767d\u677f"},eighteenPlus:{en:"Allow 18+ words",cn:"\u5141\u8bb8\u6210\u4eba\u8bcd\u6c47"},back:{en:"Back",cn:"\u8fd4\u56de"},spyPlural:{en:"spies",cn:"\u4e2a\u5367\u5e95"},spySingular:{en:"spy",cn:"\u4e2a\u5367\u5e95"},total:{en:"total",cn:"\u4e2a\u73a9\u5bb6"},roomCode:{en:"Room code",cn:"\u623f\u95f4\u53f7"},enRoom:{en:"Room in English",cn:"\u82f1\u6587\u623f\u95f4"},cnRoom:{en:"Room in Chinese",cn:"\u4e2d\u6587\u623f\u95f4"},enterRoom:{en:"Enter room",cn:"\u8fdb\u5165\u623f\u95f4"},roomFull:{en:"Room is full",cn:"\u623f\u95f4\u5df2\u6ee1"},createRoom:{en:"Create room",cn:"\u521b\u5efa\u623f\u95f4"},ok:{en:"OK",cn:"\u786e\u8ba4"},youNickname:{en:"Your nickname",cn:"\u4f60\u7684\u6635\u79f0"},exit:{en:"Exit",cn:"\u9000\u51fa"},findRoom:{en:"Find room",cn:"\u67e5\u627e\u623f\u95f4"},failJoinRoom:{en:"Failed to join room",cn:"\u52a0\u5165\u623f\u95f4\u5931\u8d25"},changeWord:{en:"Change words",cn:"\u6362\u4e00\u7ec4\u8bcd"}};return Object(u.jsx)(x.Provider,{value:{language:t,getText:function(e){return a[e][t]},getCurrentLanguage:function(){return t}},children:n})}var g=Object(d.a)((function(e){return{root:{flexGrow:1,textAlign:"center",margin:0,padding:"2rem",width:"100vw",height:"100vh",boxSizing:"border-box",color:e.palette.text.secondary,backgroundColor:"#121212"},content:{height:"60%",width:"100%",margin:e.spacing(0,"auto"),position:"absolute",top:"50%",left:"50%",msTransform:"translateY(-50%) translateX(-50%)",transform:"translateY(-50%) translateX(-50%)"},back:{position:"absolute",left:"-2rem",top:"-6rem"}}}));function f(e){var t=e.children,n=e.allowBack,c=e.allowExit,r=e.onExit,i=Object(s.f)(),o=g(),d=Object(a.useContext)(x);return n?Object(u.jsx)("div",{className:o.root,children:Object(u.jsx)(l.a,{container:!0,children:Object(u.jsxs)(l.a,{item:!0,xs:9,md:4,className:o.content,children:[Object(u.jsx)("div",{className:o.back,children:Object(u.jsxs)(j.a,{size:"large","aria-label":"back",color:"primary",variant:"text",style:{fontWeight:"bolder"},onClick:function(){return i.goBack()},children:[Object(u.jsx)(O.a,{})," ",d&&d.getText("back")]})}),t]})})}):c?Object(u.jsx)("div",{className:o.root,children:Object(u.jsx)(l.a,{container:!0,children:Object(u.jsxs)(l.a,{item:!0,xs:9,md:4,className:o.content,children:[Object(u.jsx)("div",{className:o.back,children:Object(u.jsxs)(j.a,{size:"large","aria-label":"back",color:"primary",variant:"text",style:{fontWeight:"bolder"},onClick:function(){r&&r(),i.push("/".concat(null===d||void 0===d?void 0:d.getCurrentLanguage()))},children:[Object(u.jsx)(O.a,{})," ",null===d||void 0===d?void 0:d.getText("exit")]})}),t]})})}):Object(u.jsx)("div",{className:o.root,children:Object(u.jsx)(l.a,{container:!0,children:Object(u.jsx)(l.a,{item:!0,xs:9,md:6,className:o.content,children:t})})})}function v(){return Object(u.jsx)(f,{children:Object(u.jsxs)(l.a,{container:!0,spacing:5,children:[Object(u.jsx)(m,{path:"/en",text:"English"}),Object(u.jsx)(m,{path:"/cn",text:"\u4e2d\u6587"})]})})}var y=n(16),k=n(9),w=n(145),C=n(181),N=n(195),S=n(5),R=n(197),T=Object(S.a)({root:{position:"absolute",width:"50%",left:"50%",top:"1rem"},track:{height:6},thumb:{height:"1rem",width:"1rem",border:"1px solid currentColor"},rail:{height:6,opacity:1,backgroundColor:"rgba(63, 81, 181, 0.38)","&::after":{content:'""',height:"6px",width:"100%",position:"absolute",bottom:"0px",top:"0px",left:"-100%",backgroundColor:"currentColor"}},valueLabel:{top:-46,left:"calc(-50% - 8px)","& *":{width:"2.8rem",height:"2.8rem"},"& span span":{width:"1.7rem",fontSize:"0.8rem",marginTop:"0.6rem",marginLeft:"-0.6rem"}}})(R.a),L=Object(S.a)({root:{position:"absolute",width:"30%",left:"10%",top:"1rem"},track:{height:6},rail:{backgroundColor:"rgba(0, 0, 0, 0)",opacity:1,height:0,"&::after":{content:'""',height:"6px",width:"33.33%",position:"absolute",bottom:"0px",top:"0px",left:"-33.33%",backgroundColor:"currentColor"}},thumb:{height:"1rem",width:"1rem",border:"1px solid currentColor"},mark:{color:"#424242",opacity:.8},valueLabel:{top:-46,left:"calc(-50% - 8px)","& *":{width:"2.8rem",height:"2.8rem"},"& span span":{width:"1.7rem",fontSize:"0.8rem",marginTop:"0.5rem",marginLeft:"-0.6rem"}}})(R.a),z=Object(d.a)((function(e){return{root:{position:"relative",width:"100%",height:"5rem",marginTop:"1rem"}}}));function B(e){var t=e.roomSettings,n=e.setRoomSettings,c=Object(a.useContext)(x).getText,r=z();return Object(u.jsxs)("div",{className:r.root,children:[Object(u.jsx)(T,{value:t.numPlayer,onChange:function(e,a){n(Object(y.a)(Object(y.a)({},t),{},{numPlayer:a}))},defaultValue:6,getAriaValueText:function(e){return"".concat(e," players")},"aria-labelledby":"number-of-players",step:1,min:5,max:10,marks:!0,valueLabelDisplay:"on",valueLabelFormat:function(e){return"".concat(e," ").concat(c("total"))}}),Object(u.jsx)(L,{value:t.numSpy,onChange:function(e,a){n(Object(y.a)(Object(y.a)({},t),{},{numSpy:a}))},defaultValue:2,getAriaValueText:function(e){return"".concat(e," ").concat(c("spyPlural"))},"aria-labelledby":"number-of-spys",step:1,min:1,max:4,valueLabelDisplay:"on",color:"secondary",marks:!0,valueLabelFormat:function(e){return"".concat(e," ").concat(c(e>1?"spyPlural":"spySingular"))}})]})}var P=n(44),E=n(41),F=n(144),J=n(180),I=n(67),A=n.n(I),W=Object(d.a)((function(e){return{codeDisplay:Object(E.a)({},e.breakpoints.up("md"),{width:"80%",margin:"0 auto"}),skeleton:{margin:"0 auto"}}}));function D(e){var t=e.loading,n=e.code,c=e.capacity,r=e.currentPlayerNum,i=e.language,o=Object(a.useContext)(x).getText,d=W(),b=Object(s.f)();return Object(u.jsx)(f,{allowBack:!0,children:Object(u.jsxs)("div",{children:[Object(u.jsxs)(l.a,{container:!0,style:{marginBottom:"3rem"},className:d.codeDisplay,children:[Object(u.jsx)(l.a,{item:!0,xs:11,children:Object(u.jsxs)(F.a,{align:"left",paragraph:!0,variant:"h6",display:"block",style:{margin:"1rem 0 1rem 1rem"},children:[o("roomCode"),":"]})}),t||!n?Object(P.a)(Array(4)).map((function(e,t){return Object(u.jsx)(l.a,{item:!0,xs:3,children:Object(u.jsx)(J.a,{className:d.skeleton,animation:"wave",children:Object(u.jsx)(F.a,{variant:"h2",children:"1"})})},t)})):(n+"").split("").map((function(e,t){return Object(u.jsx)(l.a,{item:!0,xs:3,children:Object(u.jsx)(F.a,{variant:"h2",children:e})},t)}))]}),void 0!==r&&void 0!==c?Object(u.jsxs)("div",{children:[Object(P.a)(Array(r)).map((function(e,t){return Object(u.jsx)(A.a,{color:"primary"},t)})),Object(P.a)(Array(c-r)).map((function(e,t){return Object(u.jsx)(A.a,{color:"disabled"},t)}))]}):Object(u.jsx)(J.a,{className:d.skeleton,animation:"wave",children:Object(P.a)(Array(7)).map((function(e,t){return Object(u.jsx)(A.a,{color:"primary"},t)}))}),void 0!==i?Object(u.jsx)(F.a,{display:"block",variant:"caption",children:o("".concat(i,"Room"))}):Object(u.jsx)(J.a,{className:d.skeleton,animation:"wave",children:Object(u.jsx)(F.a,{children:"Room in English"})}),t||!n?Object(u.jsx)(J.a,{className:d.skeleton,animation:"wave",children:r<c?Object(u.jsx)(j.a,{size:"large",variant:"contained",color:"primary",style:{marginTop:"2rem"},children:o("enterRoom")}):Object(u.jsx)(j.a,{disabled:!0,size:"large",variant:"contained",color:"primary",style:{marginTop:"2rem"},children:o("roomFull")})}):Object(u.jsx)(j.a,{size:"large",variant:"contained",color:"primary",style:{marginTop:"2rem"},onClick:function(){b.push("/".concat(i,"/room/").concat(n,"/enter"))},children:o("enterRoom")})]})})}var G=n(37),Y=n.n(G),V=n(56),M=n(94),H=n.n(M),q=function(){var e=Object(V.a)(Y.a.mark((function e(t){var n,a,c,r,i,o,s,l;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.payload,a=t.path,c=t.method,r=void 0===c?"POST":c,i=t.headers,o=void 0===i?{}:i,e.prev=1,e.next=4,H()({method:r,url:"http://".concat("192.168.1.103:8080","/").concat(a),headers:o,data:n});case 4:return s=e.sent,l=s.data,e.abrupt("return",l);case 9:throw e.prev=9,e.t0=e.catch(1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),K=Object(d.a)((function(e){return{formGroup:{width:"fit-content",margin:"1rem auto"},submitButton:{margin:"2rem 1rem 1rem 0"}}}));function X(){var e=K(),t=Object(a.useContext)(x),n=t.getText,c=t.getCurrentLanguage,r=Object(a.useState)(""),i=Object(k.a)(r,2),o=i[0],s=i[1],l=Object(a.useState)({numPlayer:6,numSpy:1,randomBlank:!0,eighteenPlus:!1,language:c()}),d=Object(k.a)(l,2),b=d[0],m=d[1],h=Object(a.useState)({loading:!1,code:void 0,capacity:6,currentPlayerNum:0,language:c(),eighteenPlus:!1}),O=Object(k.a)(h,2),p=O[0],g=O[1];return o?Object(u.jsx)("div",{children:"Error:"}):p.loading||void 0!==p.code?Object(u.jsx)(D,Object(y.a)({},p)):Object(u.jsx)(f,{allowBack:!0,children:Object(u.jsxs)("form",{children:[Object(u.jsx)(B,{roomSettings:b,setRoomSettings:m}),Object(u.jsxs)(w.a,{className:e.formGroup,children:[Object(u.jsx)(C.a,{control:Object(u.jsx)(N.a,{checked:b.randomBlank,onChange:function(e){return m((function(t){return Object(y.a)(Object(y.a)({},t),{},{randomBlank:e.target.checked})}))},name:"random-blank",color:"primary"}),label:n("randomBlank")}),Object(u.jsx)(C.a,{control:Object(u.jsx)(N.a,{checked:b.eighteenPlus,onChange:function(e){return m((function(t){return Object(y.a)(Object(y.a)({},t),{},{eighteenPlus:e.target.checked})}))},name:"eighteen-plus",color:"secondary"}),label:n("eighteenPlus")})]}),Object(u.jsx)(j.a,{className:e.submitButton,onClick:function(){g((function(e){return Object(y.a)(Object(y.a)({},e),{},{loading:!0})})),q({path:"create-room",payload:b}).then((function(e){g((function(){return Object(y.a)(Object(y.a)({},p),{},{loading:!1,code:e,capacity:b.numPlayer})}))})).catch((function(e){s(e)}))},size:"large",variant:"contained",color:"primary",children:n("createRoom")})]})})}var U=n(191),Q=n(183),Z=Object(d.a)((function(e){return{formGroup:{width:"fit-content",margin:"1rem auto"},submitButton:{margin:"1rem auto"}}}));function $(){var e=Object(a.useContext)(x).getText,t=Object(a.useState)(""),n=Object(k.a)(t,2),c=n[0],r=n[1],i=Object(a.useState)({loading:!1,code:void 0,capacity:5,currentPlayerNum:0,language:""}),o=Object(k.a)(i,2),s=o[0],l=o[1],d=Z();return s.code?Object(u.jsx)(D,Object(y.a)({},s)):Object(u.jsx)(f,{allowBack:!0,children:Object(u.jsxs)("form",{children:[Object(u.jsx)(w.a,{className:d.formGroup,children:Object(u.jsx)(U.a,{id:"room-code",label:e("roomCode"),variant:"outlined",color:"primary",value:c,autoFocus:!0,inputProps:{maxLength:4,minLength:4},onChange:function(e){r(e.target.value)}})}),s.loading?Object(u.jsx)(j.a,{className:d.submitButton,size:"large",variant:"contained",color:"primary",disabled:!0,children:Object(u.jsx)(Q.a,{})}):Object(u.jsx)(j.a,{className:d.submitButton,onClick:function(e){e.preventDefault(),l((function(e){return Object(y.a)(Object(y.a)({},e),{},{loading:!0})})),q({path:"find-room?code=".concat(c),payload:c,method:"GET"}).then((function(e){l(Object(y.a)(Object(y.a)({},e),{},{loading:!1}))}))},size:"large",variant:"contained",color:"primary",type:"submit",children:e("findRoom")})]})})}function _(){return Object(u.jsx)(f,{allowBack:!0,children:Object(u.jsx)("div",{children:"contribute"})})}var ee=n(96),te=n.n(ee),ne=n(95),ae=n.n(ne),ce=n(97),re=n.n(ce);function ie(){var e=Object(a.useContext)(x).getText,t=Object(s.h)();return Object(u.jsx)(f,{allowBack:!0,children:Object(u.jsxs)(l.a,{container:!0,spacing:5,children:[Object(u.jsx)(m,{text:e("newRoom"),icon:Object(u.jsx)(ae.a,{}),path:"".concat(t.path,"/new-room")}),Object(u.jsx)(m,{text:e("joinRoom"),icon:Object(u.jsx)(te.a,{}),path:"".concat(t.path,"/join-room")}),Object(u.jsx)(m,{text:e("addWords"),icon:Object(u.jsx)(re.a,{}),path:"".concat(t.path,"/contribute")})]})})}var oe="player-left",se="player-joined",le="player-state",je="your-word",de="game-will-start",ue="please-vote",be="talk-finish",me="vote",he="player-ready",Oe="player-left",xe="player-undo-ready",pe="word-read",ge="result-received",fe="change-word",ve=n(192),ye=n(147),ke=n(198),we=n(196),Ce=Object(d.a)((function(e){return Object(we.a)({root:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},xlarge:{width:e.spacing(12),height:e.spacing(12),padding:e.spacing(1)},large:{width:e.spacing(7),height:e.spacing(7),padding:3},medium:{width:e.spacing(6),height:e.spacing(6),padding:4},small:{width:e.spacing(5),height:e.spacing(5)},xsmall:{width:e.spacing(4),height:e.spacing(4),padding:2},avatar:{backgroundColor:"#343434"}})}));function Ne(e){var t=e.nickname,n=e.size,c=e.className,r=e.stayLoading,i=void 0!==r&&r,o=Ce(),s=Object(a.useState)(""),l=Object(k.a)(s,2),j=l[0],d=l[1];return Object(u.jsxs)("div",{className:o.root,children:[Object(u.jsx)(ke.a,{alt:t,src:"https://avatars.dicebear.com/api/bottts/".concat(t,".svg"),className:"".concat(o.avatar," ").concat(o[n]," ").concat(c),onLoad:function(){t&&d(t)},style:j!==t||i?{display:"none"}:{display:"block"}}),Object(u.jsx)(J.a,{variant:"circle",animation:"wave",className:"".concat(o[n]),style:j!==t||i?{display:"block"}:{display:"none"}})]})}var Se=Object(d.a)((function(e){return{formGroup:{width:"fit-content",margin:"1rem auto"},submitButton:{margin:"1rem auto"}}}));function Re(){var e=Se(),t=Object(a.useContext)(x).getText,n=Object(a.useContext)(ht).setNickname,c=Object(a.useState)(""),r=Object(k.a)(c,2),i=r[0],o=r[1];return Object(u.jsxs)("form",{autoComplete:"off",children:[Object(u.jsx)(Ne,{nickname:i,size:"xlarge"}),Object(u.jsx)(w.a,{className:e.formGroup,children:Object(u.jsx)(U.a,{id:"nickname",label:t("youNickname"),variant:"outlined",color:"primary",value:i,autoFocus:!0,inputProps:{maxLength:6,minLength:1},onInput:function(e){var t=e.target;o(t.value)},required:!0})}),Object(u.jsx)(j.a,{type:"submit",className:e.submitButton,onClick:function(e){e.preventDefault(),n(i)},size:"large",variant:"contained",color:"primary",children:t("ok")})]})}var Te=n(184),Le="",ze="ready",Be="reading",Pe="listening",Ee="talking",Fe="voting",Je="killed",Ie="win",Ae="lose",We="voted",De="word-changing",Ge=Object(d.a)((function(e){return{root:{marginTop:"1rem"},me:{backgroundColor:"#898989"},others:{backgroundColor:"#343434"},new:{backgroundColor:"#898989",width:"fit-content"},player:{backgroundColor:"inherit",width:"fit-content",borderRadius:"5px"},playerName:{textAlign:"center"},killed:{filter:"grayscale(100%)"}}}));function Ye(){var e=Ge(),t=Object(a.useContext)(ht),n=t.nickname,c=t.playersInRoom,r=(t.roomCapacity||0)-((null===c||void 0===c?void 0:c.length)||0);return Object(u.jsxs)(l.a,{container:!0,spacing:1,className:e.root,children:[c&&c.sort((function(e,t){return e.serialNumber-t.serialNumber})).map((function(t,a){return Object(u.jsxs)(l.a,{xs:3,item:!0,className:"".concat(e.player," ").concat(a===c.length-1?e.new:""),children:[Object(u.jsx)(Te.a,{color:(r=t.state,r===Ee?"secondary":r===Je?"default":"primary"),badgeContent:t.state?t.state:0,children:Object(u.jsx)(Ne,{nickname:t.nickname,size:"large",className:"".concat(t.nickname===n?e.me:e.others," ").concat(t.state===Je&&e.killed)})}),Object(u.jsx)(F.a,{className:e.playerName,children:n===t.nickname?"".concat(t.nickname," (you)"):t.nickname})]},a);var r})),r>0&&Object(P.a)(Array(r)).map((function(t,n){return Object(u.jsxs)(l.a,{xs:3,item:!0,className:e.player,children:[Object(u.jsx)(Ne,{size:"large",stayLoading:!0}),Object(u.jsx)(J.a,{width:50,height:23.64,style:{margin:"0 auto"},animation:"wave"})]},n)}))]})}var Ve=n(193),Me=n(68),He=n.n(Me),qe=Object(d.a)((function(e){return{root:{position:"fixed",top:"-3.5rem",left:0,right:0,width:"100%",height:"3em"}}}));function Ke(e){var t=e.alertLine,n=e.type,a=qe();return Object(u.jsx)(Ve.a,{severity:n,className:a.root,iconMapping:{success:Object(u.jsx)(He.a,{fontSize:"inherit"}),error:Object(u.jsx)(He.a,{fontSize:"inherit"}),warning:Object(u.jsx)(He.a,{fontSize:"inherit"})},children:t})}var Xe=n(99),Ue=n.n(Xe),Qe=n(185),Ze=n(186),$e=n(187),_e=n(188),et=n(98),tt=n.n(et),nt=Object(d.a)((function(e){return{main:{width:"100%",height:"10rem",display:"flex",flexDirection:"column",alignItems:"flex-end",position:"absolute",top:"3rem",margin:"0 auto",zIndex:100},invisible:{width:"6rem",height:"4rem"},wordArea:{height:"7rem"},cardArea:{height:"100%"},side:{width:"7rem",height:"5rem",position:"absolute",bottom:"0",right:"0"}}}));function at(e){var t=e.word,n=e.central,c=e.onRead,r=e.defaultHide,i=Object(a.useState)(!r),o=Object(k.a)(i,2),s=o[0],l=o[1],d=nt(),b=function(){l(!1),c()};return s?Object(u.jsxs)(Qe.a,{className:d.main,children:[Object(u.jsx)(Ze.a,{onClick:b,className:d.wordArea,children:Object(u.jsxs)($e.a,{children:[Object(u.jsx)(F.a,{variant:"caption",component:"h1",style:{textAlign:"left",paddingLeft:"1em"},children:"Your word:"}),Object(u.jsx)(F.a,{variant:"h4",component:"h1",children:t})]})}),Object(u.jsx)(_e.a,{children:Object(u.jsx)(j.a,{color:"secondary",onClick:b,children:"Got it"})})]}):Object(u.jsx)(Qe.a,{className:n?d.main:d.side,children:Object(u.jsxs)(Ze.a,{onClick:function(){return l(!0)},className:d.cardArea,children:[Object(u.jsx)(tt.a,{style:{fontSize:n?"4rem":"2rem"}}),Object(u.jsx)(F.a,{children:"See word"})]})})}var ct=n(182),rt=n(189),it=n(194);function ot(){var e=Object(a.useState)(""),t=Object(k.a)(e,2),n=t[0],c=t[1],r=Object(a.useContext)(ht),i=r.onVote,o=r.voteTargets;return Object(u.jsx)(Qe.a,{style:{position:"relative",left:"-10%",width:"120%"},children:Object(u.jsxs)($e.a,{children:[Object(u.jsx)(F.a,{variant:"h5",children:"Please vote"}),Object(u.jsxs)("form",{style:{marginTop:"1rem"},children:[Object(u.jsx)(ct.a,{component:"fieldset",children:Object(u.jsx)(rt.a,{row:!0,"aria-label":"vote",name:"vote",value:n,onChange:function(e){c(e.target.value)},children:o.map((function(e,t){return Object(u.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:5},children:[Object(u.jsx)("div",{onClick:function(){c(e)},children:Object(u.jsx)(Ne,{nickname:e,size:"large"})}),Object(u.jsx)(C.a,{value:e,control:Object(u.jsx)(it.a,{color:"primary"}),label:Object(u.jsx)("div",{children:Object(u.jsx)(F.a,{children:e})})})]},t)}))})}),Object(u.jsx)(j.a,{onClick:function(){return i(n)},color:"primary",variant:"contained",style:{marginTop:"1rem"},children:"Vote"})]})]})})}var st=Object(d.a)((function(e){return{root:{width:"100%",position:"absolute",top:"3rem",margin:"0 auto",zIndex:2},cardContent:{display:"flex",justifyContent:"center",alignItems:"center"},instruction:{marginLeft:"1rem"},children:{marginTop:3},killed:{filter:"grayscale(100%)"}}}));function lt(e){var t=e.nickname,n=e.instruction,a=e.children,c=e.killed,r=st();return Object(u.jsx)(Qe.a,{className:r.root,children:Object(u.jsxs)($e.a,{className:r.cardContent,children:[t&&Object(u.jsx)(Ne,{size:"medium",nickname:t,className:c&&r.killed||""}),Object(u.jsxs)("div",{className:r.instruction,children:[Object(u.jsx)(F.a,{variant:"h6",children:n}),a&&Object(u.jsx)("div",{className:r.children,children:a})]})]})})}function jt(){var e=Object(a.useContext)(ht),t=e.word,n=e.onTalkFinish,c=e.onWordRead,r=e.instruction,i=e.playersInRoom,o=e.alertLine,l=e.alertType,d=e.changeWord,b=e.nickname,m=e.reportResultReceived,h=Object(a.useContext)(x),O=h.getCurrentLanguage,p=h.getText,g=Object(a.useState)(Le),v=Object(k.a)(g,2),y=v[0],w=v[1],C=Object(s.f)(),N=Object(s.g)().code;Object(a.useEffect)((function(){var e;w((null===i||void 0===i||null===(e=i.find((function(e){return e.nickname===b})))||void 0===e?void 0:e.state)||Le)}),[i,b]);var S;if(y===Be)return Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(at,{word:t,onRead:c,central:!0}),Object(u.jsx)(j.a,{size:"small",style:{position:"absolute",bottom:"1rem",left:"1rem"},onClick:d,children:p("changeWord")})]})});if(y===De){var R=o&&o.split(" requested")[0]||"Someone";return Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(lt,{nickname:R,instruction:"Picking new words for you ...",children:Object(u.jsx)(Q.a,{})})]})})}return y===Ee?Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(lt,{nickname:b,instruction:"Your turn to talk",children:Object(u.jsx)(j.a,{variant:"contained",size:"small",color:"primary",onClick:function(){n()},children:"I finish"})}),Object(u.jsx)(at,{word:t,onRead:c,defaultHide:!0})]})}):y===Pe?Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(lt,{nickname:null===i||void 0===i||null===(S=i.find((function(e){return e.state===Ee})))||void 0===S?void 0:S.nickname,instruction:r}),Object(u.jsx)(at,{word:t,onRead:c,defaultHide:!0})]})}):y===Fe?Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(ot,{})]})}):y===We?Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(lt,{instruction:"Waiting for other players to vote",children:Object(u.jsx)(Q.a,{})})]})}):y===Ae||y===Ie?Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(lt,{instruction:r,children:Object(u.jsxs)("div",{children:[y===Ae&&Object(u.jsxs)(F.a,{variant:"h1",style:{color:"red"},children:["You lose",Object(u.jsx)(Ue.a,{style:{paddingLeft:"0.5rem"}})]}),y===Ie&&Object(u.jsx)(F.a,{variant:"h2",children:"You win!!"}),Object(u.jsx)(j.a,{onClick:function(){m(),C.push("/".concat(O(),"/room/").concat(N))},variant:"contained",size:"small",color:"primary",children:"OK"})]})})]})}):y===Je?Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(lt,{instruction:"You are killed",nickname:b,killed:!0})]})}):Object(u.jsx)(f,{children:Object(u.jsxs)("div",{children:[o&&Object(u.jsx)(Ke,{alertLine:o,type:l}),Object(u.jsx)(lt,{instruction:r||"Unexpected state ".concat(y),children:Object(u.jsx)(j.a,{variant:"contained",size:"small",color:"primary",onClick:function(){C.push("/".concat(O()))},children:"Back to homepage"})})]})})}var dt=Object(d.a)((function(e){var t;return{modalBody:(t={padding:e.spacing(2,4,3)},Object(E.a)(t,e.breakpoints.up("sm"),{width:"320px",height:"150px",margin:"100px auto"}),Object(E.a)(t,e.breakpoints.down("sm"),{width:"240px",height:"150px",margin:"150px auto"}),t),modalButton:{marginLeft:"200px"},marginBottom:{marginBottom:"1rem"},marginTop:{marginTop:"1rem"}}})),ut="idle-state",bt="game-on";function mt(){var e,t,n,c=Object(a.useContext)(ht),r=c.nickname,i=c.setNickname,o=c.reportExitRoom,l=c.alertLine,d=c.alertType,b=c.joinFailedMessage,m=c.roomState,h=c.setJoinFailedMessage,O=c.roomCapacity,p=c.playersInRoom,g=c.getReady,v=c.undoReady,y=Object(a.useContext)(x),k=y.getText,w=y.getCurrentLanguage,C=Object(s.g)().code,N=Object(s.g)().state,S=dt(),R=Object(s.f)(),T=function(){h&&h(""),i("")};return"play"===N?Object(u.jsx)(jt,{}):r?m===bt?(setTimeout((function(){R.push("/".concat(w(),"/room/").concat(C,"/play"))}),3e3),Object(u.jsx)(f,{allowExit:!0,onExit:o,children:Object(u.jsxs)("div",{children:[Object(u.jsx)(Q.a,{size:"5rem",className:S.marginBottom}),Object(u.jsx)(F.a,{variant:"h5",className:S.marginTop,children:"Game starting...."})]})})):(null===p||void 0===p||null===(e=p.find((function(e){return e.nickname===r})))||void 0===e?void 0:e.state)===Ie?Object(u.jsx)(f,{children:Object(u.jsx)(lt,{nickname:r,instruction:"Well done :)"})}):(null===p||void 0===p||null===(t=p.find((function(e){return e.nickname===r})))||void 0===t?void 0:t.state)===Ae?Object(u.jsx)(f,{children:Object(u.jsx)(lt,{nickname:r,instruction:"Better luck next time"})}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(ve.a,{open:""!==b,onClose:T,"aria-labelledby":"join-room-failed","aria-describedby":"join-room-failed",children:Object(u.jsxs)(ye.a,{className:S.modalBody,children:[Object(u.jsx)("h2",{children:k("failJoinRoom")}),Object(u.jsx)("p",{children:b}),Object(u.jsx)(j.a,{onClick:T,className:S.modalButton,children:k("ok")})]})}),Object(u.jsx)(f,{allowExit:!0,onExit:o,children:Object(u.jsxs)("div",{children:[l&&Object(u.jsx)(Ke,{alertLine:l,type:d}),Object(u.jsxs)(F.a,{variant:"h4",className:S.marginBottom,children:["Room ",C]}),Object(u.jsx)(Ye,{}),p&&O&&O===(null===p||void 0===p?void 0:p.length)&&((null===(n=p.find((function(e){return e.nickname===r})))||void 0===n?void 0:n.state)===ze?Object(u.jsx)(j.a,{size:"large",variant:"contained",color:"secondary",className:S.marginTop,onClick:v,children:"I'm not ready"}):Object(u.jsx)(j.a,{size:"large",variant:"contained",color:"secondary",className:S.marginTop,onClick:g,children:"I'm ready"}))]})})]}):Object(u.jsx)(f,{allowExit:!0,children:Object(u.jsx)(Re,{})})}var ht=c.a.createContext(void 0);function Ot(e){var t=e.children,n=Object(s.g)().code,c=Object(a.useState)(void 0),r=Object(k.a)(c,2),i=r[0],o=r[1],l=Object(a.useState)(void 0),j=Object(k.a)(l,2),d=j[0],b=j[1],m=Object(a.useState)(!1),h=Object(k.a)(m,2),O=h[0],x=h[1],p=Object(a.useState)(""),g=Object(k.a)(p,2),f=g[0],v=g[1],y=Object(a.useState)(),w=Object(k.a)(y,2),C=w[0],N=w[1],S=Object(a.useState)(""),R=Object(k.a)(S,2),T=R[0],L=R[1],z=Object(a.useState)(0),B=Object(k.a)(z,2),P=B[0],E=B[1],F=Object(a.useState)(""),J=Object(k.a)(F,2),I=J[0],A=J[1],W=Object(a.useState)(""),D=Object(k.a)(W,2),G=D[0],M=D[1],H=Object(a.useState)(!1),K=Object(k.a)(H,2),X=K[0],U=K[1],Q=Object(a.useState)(),Z=Object(k.a)(Q,2),$=Z[0],_=Z[1],ee=Object(a.useState)(ut),te=Object(k.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)("success"),re=Object(k.a)(ce,2),ie=re[0],ve=re[1],ye=Object(a.useRef)(null),ke=Object(a.useCallback)((function(e){if(e.instruction&&M(e.instruction),e.alert&&(e.alertType&&ve(e.alertType),v(e.alert),setTimeout((function(){return v("")}),2500)),e.action===le){var t=JSON.parse(e.payload);N(t)}e.action!==se&&e.action!==oe||N(JSON.parse(e.payload)),e.action===de&&ae(bt),e.action===je&&(A(e.payload),U(!1)),e.action===ue&&_(JSON.parse(e.payload))}),[]),we=Object(a.useCallback)((function(){var e;null===ye||void 0===ye||null===(e=ye.current)||void 0===e||e.send(JSON.stringify({action:fe,senderNickname:d,roomCode:n,payload:""}))}),[ye,d,n]),Ce=Object(a.useCallback)((function(){var e;console.log("Leaving room ",n),null===ye||void 0===ye||null===(e=ye.current)||void 0===e||e.send(JSON.stringify({action:Oe,senderNickname:d,roomCode:n,payload:""}))}),[ye,d,n]),Ne=Object(a.useCallback)((function(e){var t;null===ye||void 0===ye||null===(t=ye.current)||void 0===t||t.send(JSON.stringify({action:me,senderNickname:d,roomCode:n,payload:e}))}),[ye,d,n]),Se=Object(a.useCallback)((function(){var e;null===ye||void 0===ye||null===(e=ye.current)||void 0===e||e.send(JSON.stringify({action:be,senderNickname:d,roomCode:n,payload:""}))}),[ye,d,n]),Re=Object(a.useCallback)((function(){var e;X||(U(!0),null===ye||void 0===ye||null===(e=ye.current)||void 0===e||e.send(JSON.stringify({action:pe,senderNickname:d,roomCode:n,payload:""})))}),[ye,d,n,X]),Te=Object(a.useCallback)((function(){var e;null===ye||void 0===ye||null===(e=ye.current)||void 0===e||e.send(JSON.stringify({action:he,senderNickname:d,roomCode:n,payload:""}))}),[ye,d,n]),Le=Object(a.useCallback)(Object(V.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===ye||void 0===ye||null===(t=ye.current)||void 0===t||t.send(JSON.stringify({action:xe,senderNickname:d,roomCode:n,payload:""}));case 1:case"end":return e.stop()}}),e)}))),[ye,d,n]),ze=Object(a.useCallback)(Object(V.a)(Y.a.mark((function e(){var t;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ae(ut),A(""),null===ye||void 0===ye||null===(t=ye.current)||void 0===t||t.send(JSON.stringify({action:ge,senderNickname:d,roomCode:n,payload:""}));case 3:case"end":return e.stop()}}),e)}))),[ye,d,n]);return Object(a.useEffect)((function(){d&&n&&!O&&q({path:"ayt?nickname=".concat(d,"&roomcode=").concat(n)}).then((function(e){e.line?L(e.line):(e.numPlayer&&E(e.numPlayer),ye.current=new WebSocket("ws://".concat("192.168.1.103:8080","/ws?nickname=").concat(d,"&roomcode=").concat(n)),ye.current.onopen=function(){console.log("connected"),x(!0)},ye.current.onmessage=function(e){ke(JSON.parse(e.data))},ye.current.onclose=function(){Ce(),console.log("disconnected")})}))}),[Ce,ke,n,d,ye,O]),Object(u.jsx)(ht.Provider,{value:{id:i,setId:o,nickname:d,setNickname:b,reportExitRoom:Ce,playersInRoom:C,alertLine:f,joinFailedMessage:T,setJoinFailedMessage:L,roomCapacity:P,getReady:Te,undoReady:Le,roomState:ne,setRoomState:ae,word:I,onVote:Ne,onTalkFinish:Se,onWordRead:Re,instruction:G,voteTargets:$,reportResultReceived:ze,alertType:ie,changeWord:we},children:t})}function xt(){var e=Object(s.h)();return Object(u.jsxs)(s.c,{children:[Object(u.jsx)(s.a,{path:"".concat(e.path,"/new-room"),children:Object(u.jsx)(X,{})}),Object(u.jsx)(s.a,{path:"".concat(e.path,"/join-room"),children:Object(u.jsx)($,{})}),Object(u.jsx)(s.a,{path:"".concat(e.path,"/contribute"),children:Object(u.jsx)(_,{})}),Object(u.jsx)(s.a,{path:"".concat(e.path,"/room/:code/:state?"),children:Object(u.jsx)(Ot,{children:Object(u.jsx)(mt,{})})}),Object(u.jsx)(s.a,{path:e.path,children:Object(u.jsx)(ie,{})})]})}var pt=n(100),gt=n(190);var ft=function(){var e=Object(pt.a)({palette:{type:"dark"}});return Object(u.jsx)(gt.a,{theme:e,children:Object(u.jsx)(o.a,{children:Object(u.jsxs)(s.c,{children:[Object(u.jsx)(s.a,{path:"/en",children:Object(u.jsx)(p,{language:"en",children:Object(u.jsx)(xt,{})})}),Object(u.jsx)(s.a,{path:"/cn",children:Object(u.jsx)(p,{language:"cn",children:Object(u.jsx)(xt,{})})}),Object(u.jsx)(s.a,{path:"/",children:Object(u.jsx)(v,{})})]})})})},vt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,199)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),r(e),i(e)}))};i.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(ft,{})}),document.getElementById("root")),vt()}},[[143,1,2]]]);
//# sourceMappingURL=main.5d70618c.chunk.js.map